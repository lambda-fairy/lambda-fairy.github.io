general:
  branches:
    ignore:
      - master

machine:
  ghc:
    version: '8.0'
  ruby:
    version: '2.3'

dependencies:
  override:
    - gem install sass --no-rdoc --no-ri
    - cabal update
    - cabal install --only-dependencies -O0 -j

test:
  override:
    - cabal configure -O0 && cabal run --ghc-option=-j -- rebuild

deployment:
  push:
    branch: source
    commands:
      - deploy/deploy 'Circle CI'
